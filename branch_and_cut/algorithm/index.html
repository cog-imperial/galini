



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.1, mkdocs-material-3.0.3">
    
    
      
        <title>Algorithm - GALINI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#branch-cut-algorithm" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="GALINI" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                GALINI
              </span>
              <span class="md-header-nav__topic">
                Algorithm
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/cog-imperial/galini/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cog-imperial/galini
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="GALINI" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    GALINI
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/cog-imperial/galini/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      cog-imperial/galini
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Commands
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Commands
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/dot/" title="dot" class="md-nav__link">
      dot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/special_structure/" title="special_structure" class="md-nav__link">
      special_structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commands/plugins/" title="plugins" class="md-nav__link">
      plugins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Branch & Cut
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Branch & Cut
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Algorithm
      </label>
    
    <a href="./" title="Algorithm" class="md-nav__link md-nav__link--active">
      Algorithm
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#branch-bound-overview" title="Branch &amp; Bound Overview" class="md-nav__link">
    Branch &amp; Bound Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#branch-bound-tree" title="Branch &amp; bound tree" class="md-nav__link">
    Branch &amp; bound tree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cut-loop" title="Cut Loop" class="md-nav__link">
    Cut Loop
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cuts/" title="Cut Generation" class="md-nav__link">
      Cut Generation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/" title="API Reference" class="md-nav__link">
      API Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Branch & Bound
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Branch & Bound
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bab/tree/" title="Tree & Nodes" class="md-nav__link">
      Tree & Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bab/branching/" title="Branching" class="md-nav__link">
      Branching
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../relaxations/" title="Relaxations" class="md-nav__link">
      Relaxations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../expression_relaxations/" title="Expression Relaxations" class="md-nav__link">
      Expression Relaxations
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#branch-bound-overview" title="Branch &amp; Bound Overview" class="md-nav__link">
    Branch &amp; Bound Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#branch-bound-tree" title="Branch &amp; bound tree" class="md-nav__link">
    Branch &amp; bound tree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cut-loop" title="Cut Loop" class="md-nav__link">
    Cut Loop
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cog-imperial/galini/edit/master/docs/branch_and_cut/algorithm.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="branch-cut-algorithm">Branch &amp; Cut Algorithm<a class="headerlink" href="#branch-cut-algorithm" title="Permanent link">&para;</a></h1>
<p>GALINI Branch &amp; Cut algorithm is implemented in the <code>galini.branch_and_cut</code> module.
The main classes are:</p>
<ul>
<li><code>BranchAndCutSolver</code>: implements the solver interface and is responsible for initializing GALINI
 and managing the high level branch &amp; bound process.</li>
<li><code>BranchAndCutAlgorithm</code>: solves the problem at each branch &amp; bound node.</li>
<li><code>NodeStorage</code>: defines the data that is stored at each branch &amp; bound node.</li>
<li><code>Telemetry</code>: defines the counters that are updated and logged at each branch &amp; bound node.</li>
</ul>
<h2 id="branch-bound-overview">Branch &amp; Bound Overview<a class="headerlink" href="#branch-bound-overview" title="Permanent link">&para;</a></h2>
<p>The algorithm is as follows, using Python-like pseudo-code:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">branch_and_bound</span><span class="p">(</span><span class="n">problem</span><span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">initialize_tree</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
    <span class="n">algorithm</span> <span class="o">=</span> <span class="n">initialize_algorithm</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
    <span class="n">root_lower_bound</span><span class="p">,</span> <span class="n">root_upper_bound</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">solve_root_problem</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>

    <span class="c1"># Set tree best lower and upper bounds</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">update_state</span><span class="p">(</span><span class="n">root_lower_bound</span><span class="p">,</span> <span class="n">root_upper_bound</span><span class="p">)</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">should_terminate</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tree</span><span class="o">.</span><span class="n">has_nodes</span><span class="p">():</span>
            <span class="c1"># Terminate: explored all nodes</span>
            <span class="k">break</span>

        <span class="n">current_node</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">next_node</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">&gt;=</span> <span class="n">best_upper_bound</span><span class="p">:</span>
            <span class="c1"># The node can&#39;t produce a better feasible solution than</span>
            <span class="c1"># the current best feasible solution. </span>
            <span class="k">continue</span>

        <span class="n">node_lower_bound</span><span class="p">,</span> <span class="n">node_upper_bound</span> <span class="o">=</span> \
            <span class="n">algorithm</span><span class="o">.</span><span class="n">solve_problem</span><span class="p">(</span><span class="n">current_node</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>

        <span class="c1"># Update tree lower and upper bounds</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">update_state</span><span class="p">(</span><span class="n">node_lower_bound</span><span class="p">,</span> <span class="n">node_upper_bound</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_close</span><span class="p">(</span><span class="n">node_lower_bound</span><span class="p">,</span> <span class="n">node_upper_bound</span><span class="p">):</span>
            <span class="c1"># Node converged and there is no need to continue branching in</span>
            <span class="c1"># this part of the tree.</span>
            <span class="k">continue</span>

        <span class="c1"># Branch at node to continue exploring</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">branch_at_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</pre></div>

<p>The function <code>should_terminate</code> controls if the algorithm should continue exploring
the branch &amp; bound nodes or terminate. This function checks for:</p>
<ul>
<li>Convergence of the tree lower and upper bounds</li>
<li>Termination based on the user-defined time limit</li>
<li>Termination based on the user-defined node limit</li>
</ul>
<h3 id="branch-bound-tree">Branch &amp; bound tree<a class="headerlink" href="#branch-bound-tree" title="Permanent link">&para;</a></h3>
<p>At the center of the branch &amp; bound algorithm there are the <code>Tree</code> and <code>Node</code>
classes. The <code>Tree</code> class can be customized to use user-provided branching
and node selection strategies. </p>
<p>The <code>Tree</code> class is initialized with a root node that contains the original instance
of the problem (with the original problem bounds). After solving the problem at
the root node, the algorithm branches on one or more variables at one or more
points to create multiple children nodes. The non-root nodes don't store the
entire problem, instead they only store the variables bounds at the node and
a pointer to the parent problem.</p>
<p><img alt="Problem Tree" src="../images/problem_tree.png" /></p>
<p>When nodes are first created, they are marked as not visited and added to the queue
of nodes to be visited. At each iteration of the branch &amp; bound loop, the algorithm
pops the most promising node from the queue and solves the node problem.
The solution at the node is used to update the node state (global lower and upper
bounds).</p>
<p>The tree upper bound is the best (lowest) feasible solution found so far, the
function to update the tree upper bound is as follows:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_tree_upper_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">candidate_solution</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">candidate_solution</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">tree</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
        <span class="n">candidate_solution</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">,</span>    
    <span class="p">)</span>
</pre></div>

<p>The tree lower bound is the lowest of the open nodes lower bounds, that is the
solution of the linear relaxation of the problem. Since open nodes have not been
solved (by definition), then we consider their parent lower bound as their lower
bound. If there are no open nodes, then we consider the lower bounds of 
phatomed nodes.</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_tree_lower_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">candidate_solution</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">candidate_solution</span><span class="o">.</span><span class="n">is_feasible</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">best_lower_bound</span> <span class="o">=</span> <span class="n">infinity</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">open_nodes</span><span class="p">:</span>
        <span class="n">node_lower_bound</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">lower_bound</span>
        <span class="k">if</span> <span class="n">node_lower_bound</span> <span class="o">&lt;</span> <span class="n">best_lower_bound</span><span class="p">:</span>
            <span class="n">best_lower_bound</span> <span class="o">=</span> <span class="n">node_lower_bound</span>

    <span class="k">if</span> <span class="n">best_lower_bound</span> <span class="o">!=</span> <span class="n">infinity</span><span class="p">:</span>
        <span class="c1"># The lower bound was updated from open nodes. Finished.</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">best_lower_bound</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">phatomed_nodes</span><span class="p">:</span>
        <span class="n">node_lower_bound</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">lower_bound</span>
        <span class="k">if</span> <span class="n">node_lower_bound</span> <span class="o">&lt;</span> <span class="n">best_lower_bound</span><span class="p">:</span>
            <span class="n">best_lower_bound</span> <span class="o">=</span> <span class="n">node_lower_bound</span>

    <span class="c1"># Update lower bound.</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">best_lower_bound</span>
</pre></div>

<h2 id="cut-loop">Cut Loop<a class="headerlink" href="#cut-loop" title="Permanent link">&para;</a></h2>
<p>The Branch &amp; Cut algorithm solves the problems at each node of the branch &amp; bound
loop by relaxing the problem to a LP and generating cutting planes. The behaviour
of the cut loop can be controlled by changing the configuration.</p>
<p>The algorithm starts by trying to find a feasible solution as soon as possible.
After this, it starts a cut loop phase where it solves a series of LPs.</p>
<p>At the beginning of the cut loop, the algorithm solves the LP and then iterates
over the node parent cuts, adding any violated cut. It repeats this step until
there are no more violated cuts.</p>
<p>After this, the algorithm solves a series of LPs and calls the cuts generator to
generate new cuts that are added to the problem and the cut pool. This step
is repeated until:</p>
<ul>
<li>All the cuts generators cannot generate any more cuts</li>
<li>The maximum number of iterations is exceeded</li>
</ul>
<p>If the appropriate flag is set, the cut loop is repeated again, this time by 
solving a series of MILPs.</p>
<p>After the cut phases are finished, GALINI checks if the current node can
produce a better feasible solution by comparing the linear relaxation solution
to the tree upper bound.</p>
<p>Finally, the algorithm solves the original problem to find a feasible solution.
The heuristic used to find a feasible solution fixes all integer variables to
the values found in cut phase and then uses a NLP solver to find a (local) solution
to the problem. </p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">solve_problem_at_node</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">problem</span><span class="p">):</span>
    <span class="n">convex_problem</span> <span class="o">=</span> <span class="n">relax_problem_to_convex</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
    <span class="n">linear_problem</span> <span class="o">=</span> <span class="n">relax_problem_to_linear</span><span class="p">(</span><span class="n">convex_problem</span><span class="p">)</span>

    <span class="n">feasible_solution</span> <span class="o">=</span> <span class="n">try_find_feasible_solution</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">lp_cut_loop_active</span><span class="p">:</span>
        <span class="n">relax_integral_variables</span><span class="p">(</span><span class="n">linear_problem</span><span class="p">)</span>
        <span class="n">lower_bound_solution</span> <span class="o">=</span> <span class="n">perform_cut_loop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">convex_problem</span><span class="p">,</span> <span class="n">linear_problem</span><span class="p">)</span>
        <span class="n">restore_integral_variables</span><span class="p">(</span><span class="n">linear_problem</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">milp_cut_loop_active</span><span class="p">:</span>
        <span class="n">lower_bound_solution</span> <span class="o">=</span> <span class="n">perform_cut_loop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">convex_problem</span><span class="p">,</span> <span class="n">linear_problem</span><span class="p">)</span>  

    <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">&lt;</span> <span class="n">lower_bound_solution</span><span class="o">.</span><span class="n">objective_value</span><span class="p">:</span>
        <span class="c1"># The node will not provide an improvement, don&#39;t solve primal.</span>
        <span class="k">return</span> <span class="n">lower_bound_solution</span><span class="p">,</span> <span class="bp">None</span>

    <span class="n">upper_bound_solution</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">starting_point</span><span class="o">=</span><span class="n">lower_bound_solution</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lower_bound_solution</span><span class="p">,</span> <span class="n">upper_bound_solution</span>
</pre></div>

<p>The cut loop is the same whether GALINI is solving a MILP or a LP.</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">perform_cut_loop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">convex_problem</span><span class="p">,</span> <span class="n">linear_problem</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
        <span class="n">add_cuts_from_parent</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">linear_problem</span><span class="p">)</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">cut_loop_should_terminate</span><span class="p">():</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">linear_problem</span><span class="p">)</span>

        <span class="n">new_cuts</span> <span class="o">=</span> <span class="n">generate_cuts</span><span class="p">(</span><span class="n">convex_problem</span><span class="p">,</span> <span class="n">linear_problem</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">cut</span> <span class="ow">in</span> <span class="n">new_cuts</span><span class="p">:</span>
            <span class="c1"># Add cut to the cut pool and the linear problem</span>
            <span class="n">node</span><span class="o">.</span><span class="n">cut_pool</span><span class="o">.</span><span class="n">add_cut</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
            <span class="n">linear_problem</span><span class="o">.</span><span class="n">add_cut</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../configuration/" title="Configuration" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Configuration
              </span>
            </div>
          </a>
        
        
          <a href="../cuts/" title="Cut Generation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Cut Generation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.1",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>